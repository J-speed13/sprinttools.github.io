<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <title>Sprint Starter</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: 'Segoe UI', Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
      flex-direction: column;
      user-select: none;
      -webkit-user-select: none;
      overflow: hidden;
    }
    
    #startBtn {
      font-size: 38px;
      padding: 25px 50px;
      border-radius: 50px;
      border: none;
      background: linear-gradient(145deg, #ffffff, #e6e6e6);
      color: black;
      cursor: pointer;
      font-weight: 900;
      letter-spacing: 2px;
      transition: all 0.2s ease;
      box-shadow: 0 10px 20px rgba(255,255,255,0.1);
      -webkit-tap-highlight-color: transparent;
    }

    #startBtn:active {
      transform: scale(0.92);
      box-shadow: 0 5px 10px rgba(255,255,255,0.05);
    }

    #text {
      font-size: 80px;
      font-weight: 900;
      text-transform: uppercase;
      font-style: italic;
      letter-spacing: -2px;
      line-height: 0.9;
    }

    .status-sub {
      font-size: 20px;
      color: #666;
      margin-top: 20px;
      text-transform: uppercase;
      letter-spacing: 4px;
    }
  </style>
</head>
<body>
  
  <button id="startBtn">READY</button>
  <div id="text" style="display:none;"></div>
  <div id="subText" class="status-sub" style="display:none;">Stand By</div>

  <script>
    const btn = document.getElementById("startBtn");
    const text = document.getElementById("text");
    const subText = document.getElementById("subText");

    // --- AUDIO ENGINE ---
    let audioCtx;
    let noiseBuffer;

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // Generate 2 seconds of White Noise Buffer
        const bufferSize = audioCtx.sampleRate * 2;
        noiseBuffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = noiseBuffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
          data[i] = Math.random() * 2 - 1;
        }
      }
      if (audioCtx.state === 'suspended') {
        audioCtx.resume();
      }
    }

    function playGunShot() {
      if (!audioCtx) return;
      const t = audioCtx.currentTime;

      // Layer 1: The "Crack" (Filtered White Noise)
      const noise = audioCtx.createBufferSource();
      noise.buffer = noiseBuffer;
      
      const noiseFilter = audioCtx.createBiquadFilter();
      noiseFilter.type = 'lowpass';
      noiseFilter.frequency.setValueAtTime(3000, t); // High snap
      noiseFilter.frequency.exponentialRampToValueAtTime(100, t + 0.2); // Fast decay

      const noiseGain = audioCtx.createGain();
      noiseGain.gain.setValueAtTime(0, t);
      noiseGain.gain.linearRampToValueAtTime(5.0, t + 0.005); // High gain for distortion/loudness
      noiseGain.gain.exponentialRampToValueAtTime(0.01, t + 0.4);

      noise.connect(noiseFilter);
      noiseFilter.connect(noiseGain);
      noiseGain.connect(audioCtx.destination);
      noise.start(t);

      // Layer 2: The "Thump" (Body of the gun)
      const osc = audioCtx.createOscillator();
      osc.type = 'triangle';
      osc.frequency.setValueAtTime(150, t); // Punchy mid-low
      osc.frequency.exponentialRampToValueAtTime(40, t + 0.3); // Drop pitch

      const oscGain = audioCtx.createGain();
      oscGain.gain.setValueAtTime(0, t);
      oscGain.gain.linearRampToValueAtTime(3.0, t + 0.005);
      oscGain.gain.exponentialRampToValueAtTime(0.001, t + 0.4);

      osc.connect(oscGain);
      oscGain.connect(audioCtx.destination);
      osc.start(t);
    }

    // --- VOICE ENGINE ---
    let voices = [];
    const loadVoices = () => { voices = window.speechSynthesis.getVoices(); };
    window.speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    function getAuthoritativeMaleVoice() {
      if (voices.length === 0) loadVoices();
      // Search for deep, professional male voices
      const targets = ["Google UK English Male", "Daniel", "Microsoft David", "Male", "en-GB"];
      for (let name of targets) {
        const found = voices.find(v => v.name.includes(name));
        if (found) return found;
      }
      return null;
    }

    function shout(message, voice) {
      return new Promise((resolve) => {
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(message);
        if (voice) msg.voice = voice;
        
        // Shouty settings: Slightly slower rate for impact, lower pitch for masculinity
        msg.rate = 0.85; 
        msg.pitch = 0.6;
        msg.volume = 1.0; 
        msg.lang = 'en-GB';

        msg.onend = () => resolve();
        // Force resolve if speech takes too long
        setTimeout(resolve, 2500);
        window.speechSynthesis.speak(msg);
      });
    }

    const wait = (ms) => new Promise(res => setTimeout(res, ms));

    btn.onclick = async () => {
      // 0. Initial Setup & Audio Unlock
      initAudio();
      const maleVoice = getAuthoritativeMaleVoice();
      
      btn.style.display = "none";
      text.style.display = "block";
      subText.style.display = "block";

      // 1. ON YOUR MARKS
      text.innerText = "ON YOUR";
      text.style.color = "white";
      subText.innerText = "MARKS";
      await shout("On your marks!", maleVoice);
      await wait(7500); // Standard IAAF style long wait

      // 2. SET
      text.innerText = "SET";
      subText.innerText = "READY";
      await shout("Set!", maleVoice);
      
      // Random delay before gun (1.5s to 4.5s)
      await wait(1500 + Math.random() * 3000); 

      // 3. BANG (Synthesized Gunshot)
      text.innerText = "GO!";
      text.style.color = "#00FF00";
      subText.innerText = "FIRE";
      
      playGunShot();
      
      if (navigator.vibrate) navigator.vibrate([100, 50, 300]);

      // 4. Reset
      await wait(5000);
      text.style.display = "none";
      subText.style.display = "none";
      btn.style.display = "block";
    };
  </script>
</body>
</html>